{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 110,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: nltk in /opt/conda/lib/python3.8/site-packages (3.5)\n",
      "Requirement already satisfied: regex in /opt/conda/lib/python3.8/site-packages (from nltk) (2020.10.11)\n",
      "Requirement already satisfied: click in /opt/conda/lib/python3.8/site-packages (from nltk) (7.1.2)\n",
      "Requirement already satisfied: joblib in /opt/conda/lib/python3.8/site-packages (from nltk) (0.16.0)\n",
      "Requirement already satisfied: tqdm in /opt/conda/lib/python3.8/site-packages (from nltk) (4.48.2)\n"
     ]
    }
   ],
   "source": [
    "! pip install nltk"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "from nltk.tokenize import RegexpTokenizer\n",
    "from nltk.corpus import stopwords\n",
    "from nltk.stem.porter import PorterStemmer\n",
    "\n",
    "from sklearn.feature_extraction.text import TfidfVectorizer, CountVectorizer\n",
    "from sklearn.decomposition import NMF, LatentDirichletAllocation\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "def load_data(path,file_name):\n",
    "    \"\"\"\n",
    "    Input  : path and file_name\n",
    "    Purpose: loading text file\n",
    "    Output : list of paragraphs/documents and\n",
    "             title(initial 100 words considred as title of document)\n",
    "    \"\"\"\n",
    "    documents_list = []\n",
    "    titles=[]\n",
    "    with open( os.path.join(path, file_name) ,\"r\") as fin:\n",
    "        for line in fin.readlines():\n",
    "            text = line.strip()\n",
    "            documents_list.append(text)\n",
    "    print(\"Total Number of Documents:\",len(documents_list))\n",
    "    titles.append( text[0:min(len(text),100)] )\n",
    "    return documents_list,titles"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "topic_data.txt\ttopic_modeling.ipynb\r\n"
     ]
    }
   ],
   "source": [
    "!ls\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Total Number of Documents: 4551\n"
     ]
    }
   ],
   "source": [
    "docs, titles = load_data('/home/jovyan/git/topic_modeling'\n",
    ", 'topic_data.txt')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "def preprocess_data(doc_set):\n",
    "    \"\"\"\n",
    "    Input  : docuemnt list\n",
    "    Purpose: preprocess text (tokenize, removing stopwords, and stemming)\n",
    "    Output : preprocessed text\n",
    "    \"\"\"\n",
    "    # initialize regex tokenizer\n",
    "    tokenizer = RegexpTokenizer(r'\\w+')\n",
    "    # create English stop words list\n",
    "    en_stop = set(stopwords.words('english'))\n",
    "    # Create p_stemmer of class PorterStemmer\n",
    "    p_stemmer = PorterStemmer()\n",
    "    # list for tokenized documents in loop\n",
    "    texts = []\n",
    "    # loop through document list\n",
    "    for i in doc_set:\n",
    "        # clean and tokenize document string\n",
    "        raw = i.lower()\n",
    "        tokens = tokenizer.tokenize(raw)\n",
    "        # remove stop words from tokens\n",
    "        stopped_tokens = [i for i in tokens if not i in en_stop]\n",
    "        # stem tokens\n",
    "        stemmed_tokens = [p_stemmer.stem(i) for i in stopped_tokens]\n",
    "        # add tokens to list\n",
    "        stemmed_tokens = ' '.join(stemmed_tokens)\n",
    "        texts.append(stemmed_tokens)\n",
    "        \n",
    "    return texts"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "prep_docs = preprocess_data(docs)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "4551"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(prep_docs)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "def tfidf_vectorizer(prep_docs, n_features = 50, param_min_df = 2, param_max_df = 0.95):\n",
    "\n",
    "    print(\"Extracting tf-idf features ...\")\n",
    "    tfidf = TfidfVectorizer(max_df = param_max_df, min_df = param_min_df,\n",
    "                                       max_features=n_features,\n",
    "                                       stop_words='english')\n",
    "    # tfidf_vec_sparse = tfidf.fit_transform(docs)\n",
    "    tfidf_vec_sparse = tfidf.fit_transform(prep_docs)\n",
    "    feature_names = tfidf.get_feature_names()\n",
    "\n",
    "    return tfidf_vec_sparse, feature_names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Extracting tf-idf features ...\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ask</th>\n",
       "      <th>bank</th>\n",
       "      <th>brexit</th>\n",
       "      <th>campaign</th>\n",
       "      <th>chang</th>\n",
       "      <th>citi</th>\n",
       "      <th>clinton</th>\n",
       "      <th>come</th>\n",
       "      <th>countri</th>\n",
       "      <th>day</th>\n",
       "      <th>...</th>\n",
       "      <th>trump</th>\n",
       "      <th>uk</th>\n",
       "      <th>use</th>\n",
       "      <th>vote</th>\n",
       "      <th>want</th>\n",
       "      <th>way</th>\n",
       "      <th>week</th>\n",
       "      <th>work</th>\n",
       "      <th>world</th>\n",
       "      <th>year</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.290731</td>\n",
       "      <td>0.855437</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.109713</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.076709</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.075749</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.058920</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.737285</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.239646</td>\n",
       "      <td>...</td>\n",
       "      <td>0.487522</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.082145</td>\n",
       "      <td>0.108071</td>\n",
       "      <td>0.081123</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.259301</td>\n",
       "      <td>0.320335</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.279841</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.292588</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.046292</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.290619</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.052408</td>\n",
       "      <td>0.141971</td>\n",
       "      <td>0.036642</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.038455</td>\n",
       "      <td>...</td>\n",
       "      <td>0.586729</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.052025</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.041094</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.046648</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.244046</td>\n",
       "      <td>0.171658</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.429190</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.091230</td>\n",
       "      <td>0.155004</td>\n",
       "      <td>...</td>\n",
       "      <td>0.650369</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.079698</td>\n",
       "      <td>0.104851</td>\n",
       "      <td>0.078705</td>\n",
       "      <td>0.072924</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.034682</td>\n",
       "      <td>0.124992</td>\n",
       "      <td>0.056722</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 50 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        ask      bank  brexit  campaign     chang      citi   clinton  \\\n",
       "0  0.290731  0.855437     0.0  0.000000  0.000000  0.109713  0.000000   \n",
       "1  0.000000  0.000000     0.0  0.000000  0.000000  0.000000  0.737285   \n",
       "2  0.000000  0.000000     0.0  0.000000  0.000000  0.000000  0.000000   \n",
       "3  0.046292  0.000000     0.0  0.290619  0.000000  0.052408  0.141971   \n",
       "4  0.046648  0.000000     0.0  0.244046  0.171658  0.000000  0.429190   \n",
       "\n",
       "       come   countri       day  ...     trump   uk       use      vote  \\\n",
       "0  0.076709  0.000000  0.000000  ...  0.000000  0.0  0.000000  0.000000   \n",
       "1  0.000000  0.000000  0.239646  ...  0.487522  0.0  0.082145  0.108071   \n",
       "2  0.259301  0.320335  0.000000  ...  0.000000  0.0  0.279841  0.000000   \n",
       "3  0.036642  0.000000  0.038455  ...  0.586729  0.0  0.000000  0.052025   \n",
       "4  0.000000  0.091230  0.155004  ...  0.650369  0.0  0.079698  0.104851   \n",
       "\n",
       "       want       way      week      work     world      year  \n",
       "0  0.000000  0.075749  0.000000  0.000000  0.000000  0.058920  \n",
       "1  0.081123  0.000000  0.000000  0.000000  0.000000  0.000000  \n",
       "2  0.000000  0.000000  0.000000  0.000000  0.292588  0.000000  \n",
       "3  0.000000  0.000000  0.041094  0.000000  0.000000  0.000000  \n",
       "4  0.078705  0.072924  0.000000  0.034682  0.124992  0.056722  \n",
       "\n",
       "[5 rows x 50 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# tfidf_vec_sparse = tfidf.fit_transform(docs)\n",
    "tfidf_vec_sparse, feature_names = tfidf_vectorizer(prep_docs, n_features = 50, param_min_df = 2, param_max_df = 0.95)\n",
    "\n",
    "tfidf_vec_df = pd.DataFrame(tfidf_vec_sparse.toarray(), \n",
    "                        columns=tfidf.get_feature_names())\n",
    "tfidf_vec_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "tfidf_vec_sparse.toarray().shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "LatentDirichletAllocation(learning_method='online', learning_offset=50.0,\n",
       "                          max_iter=5, random_state=0)"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "n_topics = 10\n",
    "from sklearn.decomposition import TruncatedSVD\n",
    "lsa = TruncatedSVD(n_components=n_topics, n_iter=100, random_state=42)\n",
    "lda = LatentDirichletAllocation(n_components=n_topics, max_iter=5,\n",
    "                                learning_method='online',\n",
    "                                learning_offset=50.,\n",
    "                                random_state=0)\n",
    "\n",
    "lsa.fit(tfidf_vec_sparse)\n",
    "lda.fit(tfidf_vec_sparse)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "lsa"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [],
   "source": [
    "emd = lsa.transform(tfidf_vec_sparse.toarray())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(4551, 10)"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "emd.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "sing_vals = lsa.singular_values_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x7fcbf0a00460>"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAXAAAAD4CAYAAAD1jb0+AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAOZUlEQVR4nO3dfYxldX3H8ffHXQwINKA7kC0PXTWESGxY6GRLuwlaUbvaVrTRRhIpbTTrH2CgNW2oJhWbmNjUhyZtY7IKdY1IgzxEaoy6xQeisdBZXGTpavEBcXVlx1oLtkkV/PaPe9YM4wz37sy9594fvF/JzT333HPn+8kw++HMuefcSVUhSWrP06YdQJK0Nha4JDXKApekRlngktQoC1ySGrWxz2GbNm2qLVu29DlSkpq3d+/eH1TV3PL1vRb4li1bWFhY6HOkJDUvybdXWu8hFElqlAUuSY2ywCWpURa4JDXKApekRlngktQoC1ySGmWBS1KjLHBJalSvV2Iu9Wt/9qHeZu39mz/sbZYk9cU9cElqlAUuSY2ywCWpURa4JDXKApekRlngktQoC1ySGmWBS1KjLHBJapQFLkmNssAlqVEWuCQ1ygKXpEZZ4JLUqKEFnuTYJHcluSfJfUne3q1/ZpI9Se7v7k+efFxJ0hGj7IH/H/CiqjoX2ArsSHIBcDVwe1WdBdzePZYk9WRogdfAj7uHx3S3Ai4GdnfrdwOvnEhCSdKKRjoGnmRDkn3AYWBPVd0JnFpVhwC6+1NWee3OJAtJFhYXF8eVW5Ke8kYq8Kp6rKq2AqcD25I8f9QBVbWrquaran5ubm6tOSVJyxzVWShV9SPgc8AO4KEkmwG6+8NjTydJWtUoZ6HMJTmpWz4OeDHwVeA24LJus8uAj00qpCTpF43yV+k3A7uTbGBQ+DdW1ceTfAm4McnrgQeB10wwpyRpmaEFXlVfAc5bYf1/AhdNIpQkaTivxJSkRlngktQoC1ySGmWBS1KjLHBJapQFLkmNssAlqVEWuCQ1ygKXpEZZ4JLUKAtckhplgUtSoyxwSWqUBS5JjbLAJalRFrgkNcoCl6RGWeCS1CgLXJIaZYFLUqMscElqlAUuSY0aWuBJzkjy2SQHktyX5Mpu/TVJvptkX3d7+eTjSpKO2DjCNo8Cb66qu5OcCOxNsqd77r1V9a7JxZMkrWZogVfVIeBQt/xIkgPAaZMOJkl6Ykd1DDzJFuA84M5u1RVJvpLkuiQnjzmbJOkJjFzgSU4AbgauqqqHgfcBzwW2MthDf/cqr9uZZCHJwuLi4hgiS5JgxAJPcgyD8r6+qm4BqKqHquqxqvoZ8H5g20qvrapdVTVfVfNzc3Pjyi1JT3mjnIUS4FrgQFW9Z8n6zUs2exWwf/zxJEmrGeUslO3ApcC9SfZ1694CXJJkK1DAA8AbJ5JQkrSiUc5C+QKQFZ76xPjjSJJG5ZWYktQoC1ySGmWBS1KjLHBJapQFLkmNssAlqVEWuCQ1ygKXpEZZ4JLUKAtckhplgUtSoyxwSWqUBS5JjbLAJalRFrgkNcoCl6RGWeCS1CgLXJIaZYFLUqMscElqlAUuSY2ywCWpURa4JDVqaIEnOSPJZ5McSHJfkiu79c9MsifJ/d39yZOPK0k6YpQ98EeBN1fV84ALgMuTnANcDdxeVWcBt3ePJUk9GVrgVXWoqu7ulh8BDgCnARcDu7vNdgOvnFRISdIvOqpj4Em2AOcBdwKnVtUhGJQ8cMoqr9mZZCHJwuLi4vrSSpJ+buQCT3ICcDNwVVU9POrrqmpXVc1X1fzc3NxaMkqSVjBSgSc5hkF5X19Vt3SrH0qyuXt+M3B4MhElSSsZ5SyUANcCB6rqPUueug24rFu+DPjY+ONJklazcYRttgOXAvcm2detewvwTuDGJK8HHgReM5mIkqSVDC3wqvoCkFWevmi8cSRJoxplD/xJ7cG/+tXeZp35l/f2NkvSk5+X0ktSoyxwSWqUBS5JjbLAJalRFrgkNeopfxbKLNj+d9t7m/XFN32xt1mSJss9cElqlAUuSY2ywCWpURa4JDXKApekRlngktQoC1ySGmWBS1KjLHBJapQFLkmNssAlqVEWuCQ1yg+z0s99/sIX9DbrBXd8vrdZ0pOVe+CS1CgLXJIaNbTAk1yX5HCS/UvWXZPku0n2dbeXTzamJGm5UfbAPwjsWGH9e6tqa3f7xHhjSZKGGfomZlXdkWTL5KNI8Pdv/ufeZl3x7t/rbZY0Ces5Bn5Fkq90h1hOXm2jJDuTLCRZWFxcXMc4SdJSay3w9wHPBbYCh4B3r7ZhVe2qqvmqmp+bm1vjOEnScmsq8Kp6qKoeq6qfAe8Hto03liRpmDUVeJLNSx6+Cti/2raSpMkY+iZmkhuAFwKbkhwE3ga8MMlWoIAHgDdOMKMkaQWjnIVyyQqrr51AFknSUfBKTElqlAUuSY2ywCWpURa4JDXKApekRlngktQoC1ySGmWBS1KjLHBJapQFLkmNssAlqVFDPwtFeip6x+te3cuct374pl7m6MnJPXBJapQFLkmNssAlqVEWuCQ1ygKXpEZZ4JLUKE8jlGbUgXd8prdZz3vri3qbpfFxD1ySGmWBS1KjLHBJapQFLkmNGlrgSa5LcjjJ/iXrnplkT5L7u/uTJxtTkrTcKHvgHwR2LFt3NXB7VZ0F3N49liT1aGiBV9UdwA+Xrb4Y2N0t7wZeOeZckqQh1noe+KlVdQigqg4lOWW1DZPsBHYCnHnmmWscJ2larrnmmifVnCeTib+JWVW7qmq+qubn5uYmPU6SnjLWWuAPJdkM0N0fHl8kSdIo1lrgtwGXdcuXAR8bTxxJ0qhGOY3wBuBLwNlJDiZ5PfBO4CVJ7gde0j2WJPVo6JuYVXXJKk9dNOYskqSj4KcRSpp5N350W2+z/uA1d6363Lk3faqXDPe8+rdH2s5L6SWpURa4JDXKApekRlngktQoC1ySGmWBS1KjLHBJapQFLkmNssAlqVEWuCQ1ygKXpEZZ4JLUKAtckhplgUtSoyxwSWqUBS5JjbLAJalRFrgkNcoCl6RGWeCS1CgLXJIata6/Sp/kAeAR4DHg0aqaH0coSdJw6yrwzm9V1Q/G8HUkSUfBQyiS1Kj1FngBn06yN8nOlTZIsjPJQpKFxcXFdY6TJB2x3gLfXlXnAy8DLk9y4fINqmpXVc1X1fzc3Nw6x0mSjlhXgVfV97r7w8CtwLZxhJIkDbfmAk9yfJITjywDLwX2jyuYJOmJrecslFOBW5Mc+TofqapPjiWVJGmoNRd4VX0TOHeMWSRJR8HTCCWpURa4JDXKApekRlngktQoC1ySGmWBS1KjLHBJapQFLkmNssAlqVEWuCQ1ygKXpEZZ4JLUKAtckhplgUtSoyxwSWqUBS5JjbLAJalRFrgkNcoCl6RGWeCS1CgLXJIaZYFLUqMscElq1LoKPMmOJF9L8vUkV48rlCRpuDUXeJINwD8ALwPOAS5Jcs64gkmSnth69sC3AV+vqm9W1U+AfwIuHk8sSdIwqaq1vTB5NbCjqt7QPb4U+PWqumLZdjuBnd3Ds4GvrT0uAJuAH6zza6zXLGSA2cgxCxlgNnLMQgaYjRyzkAFmI8c4MvxKVc0tX7lxHV8wK6z7hf8bVNUuYNc65jx+aLJQVfPj+nqtZpiVHLOQYVZyzEKGWckxCxlmJcckM6znEMpB4Iwlj08Hvre+OJKkUa2nwP8NOCvJs5M8HXgtcNt4YkmShlnzIZSqejTJFcCngA3AdVV139iSrW5sh2PWYRYywGzkmIUMMBs5ZiEDzEaOWcgAs5FjYhnW/CamJGm6vBJTkhplgUtSo5op8Fm4bD/JdUkOJ9k/jfldhjOSfDbJgST3JblySjmOTXJXknu6HG+fRo4uy4YkX07y8SlmeCDJvUn2JVmYUoaTktyU5Kvdz8dvTCHD2d334Mjt4SRXTSHHn3Q/l/uT3JDk2ClkuLKbf9/EvgdVNfM3Bm+SfgN4DvB04B7gnCnkuBA4H9g/xe/FZuD8bvlE4D+m9L0IcEK3fAxwJ3DBlL4nfwp8BPj4FP+7PABsmtb8LsNu4A3d8tOBk6acZwPwfQYXofQ59zTgW8Bx3eMbgT/qOcPzgf3AMxicLPIvwFnjntPKHvhMXLZfVXcAP+x77rIMh6rq7m75EeAAgx/YvnNUVf24e3hMd+v9HfEkpwO/A3yg79mzJMkvMdjBuBagqn5SVT+abiouAr5RVd+ewuyNwHFJNjIo0b6vUXke8K9V9b9V9SjweeBV4x7SSoGfBnxnyeODTKG0Zk2SLcB5DPZ+pzF/Q5J9wGFgT1VNI8ffAn8O/GwKs5cq4NNJ9nYfH9G35wCLwD92h5M+kOT4KeRY6rXADX0PrarvAu8CHgQOAf9dVZ/uOcZ+4MIkz0ryDODlPP7Cx7FopcBHumz/qSTJCcDNwFVV9fA0MlTVY1W1lcFVuNuSPL/P+Ul+FzhcVXv7nLuK7VV1PoNP57w8yYU9z9/I4PDe+6rqPOB/gKl9xHN3cd8rgI9OYfbJDH5Dfzbwy8DxSV7XZ4aqOgD8NbAH+CSDw76PjntOKwXuZftLJDmGQXlfX1W3TDtP96v654AdPY/eDrwiyQMMDqu9KMmHe84AQFV9r7s/DNzK4LBfnw4CB5f8FnQTg0KflpcBd1fVQ1OY/WLgW1W1WFU/BW4BfrPvEFV1bVWdX1UXMjj0ev+4Z7RS4F6230kSBsc5D1TVe6aYYy7JSd3ycQz+0Xy1zwxV9RdVdXpVbWHwM/GZqup1TwsgyfFJTjyyDLyUwa/Qvamq7wPfSXJ2t+oi4N/7zLDMJUzh8EnnQeCCJM/o/r1cxOC9ol4lOaW7PxP4fSbw/VjPpxH2pqZ32f7jJLkBeCGwKclB4G1VdW3PMbYDlwL3dsefAd5SVZ/oOcdmYHf3hz2eBtxYVVM7jW/KTgVuHXQFG4GPVNUnp5DjTcD13U7ON4E/nkIGumO+LwHeOI35VXVnkpuAuxkctvgy07mk/uYkzwJ+ClxeVf817gFeSi9JjWrlEIokaRkLXJIaZYFLUqMscElqlAUuSY2ywCWpURa4JDXq/wFJJ1Gw4D7G8QAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import seaborn as sns\n",
    "\n",
    "sns.barplot(x=list(range(len(sing_vals))), y = sing_vals)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(10, 50)"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "lsa.components_.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": [
    "def print_top_words(model, feature_names, n_top_words):\n",
    "    for topic_idx, topic in enumerate(model.components_):\n",
    "        message = \"Topic #%d: \" % topic_idx\n",
    "        message += \" \".join([feature_names[i]\n",
    "                             for i in topic.argsort()[:-n_top_words - 1:-1]])\n",
    "        print(message)\n",
    "    print()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Exploratory Data Analysis (EDA)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Topic #0: said year like peopl say time film new trump work\n",
      "Topic #1: trump clinton said campaign vote state eu parti polit brexit\n",
      "Topic #2: bank eu uk brexit said govern vote leav report year\n",
      "Topic #3: bank film trump said clinton report includ year state new\n",
      "Topic #4: film eu brexit uk vote leav campaign govern parti said\n",
      "Topic #5: said report year includ peopl use need support govern ask\n",
      "Topic #6: play citi point said time eu end start look right\n",
      "Topic #7: year uk new includ world live report week citi govern\n",
      "Topic #8: citi say report govern peopl support point parti film need\n",
      "Topic #9: uk say play use trump eu includ citi good world\n",
      "\n"
     ]
    }
   ],
   "source": [
    "n_top_words = 10\n",
    "print_top_words(lsa, feature_names, n_top_words)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Topic #0: bank said year govern uk report new time includ say\n",
      "Topic #1: govern countri said peopl uk year need right support world\n",
      "Topic #2: say peopl like thing work year time know want think\n",
      "Topic #3: eu brexit vote uk said leav campaign govern peopl say\n",
      "Topic #4: trump clinton said state campaign vote peopl polit parti support\n",
      "Topic #5: play citi time point like said look year start good\n",
      "Topic #6: live like year new make end world way time come\n",
      "Topic #7: parti polit vote right brexit peopl chang work like new\n",
      "Topic #8: film play year new like work time make said world\n",
      "Topic #9: said year report use includ peopl new work uk time\n",
      "\n"
     ]
    }
   ],
   "source": [
    "n_top_words = 10\n",
    "print_top_words(lda, feature_names, n_top_words)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.manifold import TSNE\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [],
   "source": [
    "tsne = TSNE(n_components=2)\n",
    "tsne_emb = tsne.fit_transform(emd)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [],
   "source": [
    "from nltk.tokenize import word_tokenize\n",
    "import string\n",
    "\n",
    "path='news_data'\n",
    "if not os.path.exists(path):\n",
    "    os.mkdir(path)\n",
    "\n",
    "url = \"https://archive.ics.uci.edu/ml/machine-learning-databases/20newsgroups-mld/20_newsgroups.tar.gz\"\n",
    "\n",
    "response = requests.get(url)\n",
    "name = os.path.basename(url)\n",
    "with open(os.path.join(path, name), 'bw') as f:\n",
    "    f.write(response.content)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {},
   "outputs": [],
   "source": [
    "TEXT_DIR = 'news_data/20_newsgroups'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 139,
   "metadata": {},
   "outputs": [],
   "source": [
    "news_topics = []\n",
    "new_text = []\n",
    "c= 0\n",
    "for names in sorted(os.listdir(TEXT_DIR)):\n",
    "    c+=1\n",
    "    path = os.path.join(TEXT_DIR, names)\n",
    "    if c < 3:\n",
    "        if os.path.isdir(path):\n",
    "            news_topics.append(names)\n",
    "            for fname in sorted(os.listdir(path)):\n",
    "                fpath = os.path.join(path, fname)\n",
    "                with open(fpath, 'rb') as f:\n",
    "                    t = f.read().decode('utf-8',errors='ignore')\n",
    "                    t = clean_text(t)\n",
    "                    new_text.append(t)\n",
    "                    \n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 141,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'xref cantaloupesrvcscmuedu path cantaloupesrvcscmuedu crabapplesrvcscmuedu europaenggtefsdcom howlandrestonansnet agate netsys ibmpcug mantis mathew mathew mathew mantiscouk newsgroups altatheism altatheismmoderated newsanswers altanswers subject altatheism faq introduction atheism summary please read file posting altatheism keywords faq atheism messageid mantiscouk date mon apr gmt expires thu may gmt followupto altatheism distribution world organization mantis consultants cambridge uk approved newsanswersrequest mitedu supersedes mantiscouk lines archivename atheismintroduction altatheismarchivename introduction lastmodified april version begin pgp signed message introduction atheism mathew mathew mantiscouk article attempts provide general introduction atheism whilst tried neutral possible regarding contentious issues always remember document represents one viewpoint would encourage read widely draw conclusions relevant books listed companion article provide sense cohesion progression presented article imaginary conversation atheist theist questions asked imaginary theist questions cropped repeatedly altatheism since newsgroup created frequently asked questions answered companion article please note article arguably slanted towards answering questions posed christian viewpoint faq files reflect questions actually asked predominantly christians proselytize altatheism talk religion talking primarily religions christianity judaism islam involve sort superhuman divine much discussion apply religions may atheism atheism characterized absence belief existence god atheists go believe god exist former often referred weak atheist position latter strong atheism important note difference two positions weak atheism simple scepticism disbelief existence god strong atheism positive belief god exist please fall trap assuming atheists strong atheists atheists believe nonexistence gods others limit atheism specific gods christian god rather making flatout denials nt disbelieving god thing believing nt exist definitely disbelief proposition means one believe true believing something true equivalent believing false one may simply idea whether true brings us agnosticism agnosticism term agnosticism coined professor huxley meeting metaphysical society defined agnostic someone disclaimed strong atheism believed ultimate origin things must cause unknown unknowable thus agnostic someone believes know sure whether god exists words slippery things language inexact beware assuming work someone philosophical point view simply fact calls atheist agnostic example many people use agnosticism mean weak atheism use word atheism referring strong atheism beware also word atheist many shades meaning difficult generalize atheists say sure atheists nt believe god example certainly isnt case atheists believe science best way find universe philosophical justification basis atheism many philosophical justifications atheism find particular person chooses atheist best ask many atheists feel idea god presented major religions essentially selfcontradictory logically impossible god could exist others atheists scepticism see evidence god exists nt impossible prove nonexistence something many counterexamples statement example quite simple prove exist prime number larger prime numbers course deals welldefined objects obeying welldefined rules whether gods universes similarly welldefined matter debate however assuming moment existence god provably impossible still subtle reasons assuming nonexistence god assume something exist always possible show assumption invalid finding single counterexample hand assume something exist thing question provably impossible showing assumption invalid may require exhaustive search possible places thing might found show nt exhaustive search often impractical impossible problem largest primes prove nt exist therefore generally accepted must assume things exist unless evidence even theists follow rule time nt believe unicorns even though ca nt conclusively prove unicorns exist anywhere assume god exists make assumption probably tested make exhaustive search everywhere god might prove nt exist anywhere sceptical atheist assumes default god exist since assumption test profess strong atheism usually claim sort god exists instead generally restrict claims cover varieties god described followers various religions whilst may impossible prove conclusively god exists may possible prove say god described particular religious book exist may even possible prove god described presentday religion exists practice believing god described religion exists close believing god exists however sufficiently different counterarguments based impossibility disproving every kind god really applicable god essentially nondetectable god interacts universe way effects interaction must measurable hence interaction universe must detectable god essentially nondetectable must therefore case interact universe way many atheists would argue god interact universe importance whether exists bible believed god easily detectable israelites surely still detectable today note demanding god interact scientifically verifiable physical way must surely possible perceive effect caused presence though otherwise distinguish things nt exist ok may think philosophical justification atheism nt still religious belief one common pastimes philosophical discussion redefinition game cynical view game follows person begins making contentious statement person b points ca nt true person gradually redefines words used statement arrives something person b prepared accept records statement along fact person b agreed continues eventually uses statement agreed fact uses original definitions words rather obscure redefinitions originally needed get b agree rather seen apparently inconsistent b tend play along point digression answer question isnt atheism religious belief depends crucially upon meant religious religion generally characterized belief superhuman controlling power especially sort god faith worship worth pointing passing varieties buddhism religion according definition atheism certainly belief sort superhuman power categorized worship meaningful sense widening definition religious encompass atheism tends result many aspects human behaviour suddenly becoming classed religious well science politics watching tv ok religion surely belief atheism science still act faith like religion firstly entirely clear sceptical atheism something one actually believes secondly necessary adopt number core beliefs assumptions make sort sense sensory data experience atheists try adopt core beliefs possible even subject questioning experience throws doubt science number core assumptions example generally assumed laws physics observers sort core assumptions atheists make basic ideas called acts faith almost everything know must said based acts faith term loses meaning faith often used refer complete certain belief something according definition atheism science certainly acts faith course individual atheists scientists dogmatic religious followers claiming something certain general tendency however many atheists would reluctant state certainty universe exists faith also used refer belief without supporting evidence proof sceptical atheism certainly nt fit definition sceptical atheism beliefs strong atheism closer still nt really match even dogmatic atheist tend refer experimental data lack asserting god exist atheism religious surely antireligious unfortunate human tendency label everyone either friend enemy truth clearcut atheism position runs logically counter theism sense said antireligion however religious believers speak atheists antireligious usually mean atheists sort antipathy hatred towards theists categorization atheists hostile towards religion quite unfair atheist attitudes towards theists fact cover broad spectrum atheists take live let live attitude unless questioned usually mention atheism except perhaps close friends course may part atheism socially acceptable many countries atheists quite antireligious may even try convert others possible historically antireligious atheists made little impact society outside eastern bloc countries digress slightly soviet union originally dedicated separation church state like usa soviet citizens legally free worship wished institution state atheism came stalin took control soviet union tried destroy churches order gain complete power population atheists quite vocal beliefs see religion encroaching matters business example government usa individuals usually concerned church state remain separate nt allow religion say running state surely state atheism principle separation church state state shall legislate concerning matters religious belief particular means state promote one religion expense another also promote belief religious nature religions still say discussion purely secular matters example religious believers historically responsible encouraging many political reforms even today many organizations campaigning increase spending foreign aid founded religious campaigns long campaign concerning secular matters long discriminate religious grounds atheists quite happy see say prayer schools god care people pray people pray voters lawmakers tend things nt pray ca nt ignore also christian prayer schools intimidating nonchristians even told need join diversity religious nonreligious belief means impossible formulate meaningful prayer acceptable present public event also nonprayers tend friends family pray reasonable care friends family wasting time even without motives mentioned christians campaign increased foreign aid atheists nt atheist charities hospitals dont atheists object religious charities many charities without religious purpose atheists contribute atheists contribute religious charities well sake practical good atheists even voluntary work charities founded theistic basis atheists seem feel atheism nt worth shouting connection charity atheism simple obvious everyday matter charity many feel somewhat cheap say selfrighteous use simple charity excuse plug particular set religious beliefs weak atheists building hospital say believe god rather strange idea rather like holding party say today birthday fuss atheism rarely evangelical said atheism nt antireligious perhaps backlash one upbringing way rebelling perhaps many people parents attempt force religious atheist ideas upon many people choose call atheists also doubtless case religious people chose religion backlash atheist upbringing way different hand many people choose religion way conforming expectations others whole ca nt conclude much whether atheism religion backlash conformism although general people tendency go along group rather act think independently atheists differ religious people nt believe god atheists may listen heavy metal backwards even may prefer verdi requiem even know words may wear hawaiian shirts may dress black may even wear orange robes many buddhists lack belief sort god atheists even carry copy bible around arguing course whoever chances met several atheists without realising atheists usually unexceptional behaviour appearance unexceptional nt atheists less moral religious people depends define morality obedience god course atheists less moral nt obey god usually one talks morality one talks acceptable right unacceptable wrong behaviour within society humans social animals maximally successful must cooperate good enough reason discourage atheists antisocial immoral behaviour purely purposes selfpreservation many atheists behave moral compassionate way simply feel natural tendency empathize humans care happens others nt know simply way naturally people behave immorally try use atheism justify actions however equally many people behave immorally try use religious beliefs justify actions example trustworthy saying deserves full acceptance jesus christ came world save sinners reason shown mercy jesus christ might display unlimited patience example would believe receive eternal life king eternal immortal invisible god honor glory forever ever quote statement made court february jeffrey dahmer notorious cannibal serial killer milwaukee wisconsin seems every atheist massmurderer religious massmurderer trivial morality survey conducted roper organization found behavior deteriorated born experiences respondents said driven intoxicated born done conversion similarly used illegal drugs conversion two percent admitted engaging illicit sex salvation freethought today september p seems best religion monopoly moral behaviour thing atheist morality mean thing morality atheists answer yes explained many atheists ideas morality least strong held religious people mean atheism characteristic moral code answer atheism imply anything much person behave atheists follow many moral rules theists different reasons atheists view morality something created humans according way humans feel world ought work rather seeing set rules decreed supernatural nt atheists theists denying god study freedom religion foundation found atheists responded became atheists religion work found religious beliefs fundamentally incompatible observed around atheists unbelievers ignorance denial unbelievers choice vast majority spent time studying one religions sometimes great depth made careful considered decision reject religious beliefs decision may course inevitable consequence individual personality naturally sceptical person choice atheism often one makes sense hence choice person honestly make nt atheists want believe god atheists live lives though nobody watching many desire watched matter goodnatured big brother figure might atheists would like able believe god one believe things merely one wants true risks approach obvious atheists often decide wanting believe something enough must evidence belief course atheists see evidence existence god unwilling souls see many atheists previously religious explained vast majority seriously considered possibility god exists many atheists spent time prayer trying reach god course true atheists lack open mind assuming atheists biased insincere offensive closedminded comments course god nt looking properly likely viewed patronizing certainly wish engage philosophical debate atheists vital give benefit doubt assume sincere say searched god willing believe basically telling truth debate futile nt whole life completely pointless atheist many atheists live purposeful life decide think gives meaning life pursue goals try make lives count wishing eternal life influence people live example atheist may dedicate life political reform hope leaving mark history natural human tendency look meaning purpose random events however means obvious life sort thing meaning put another way everything looks like question actually sensible thing ask atheists believe asking meaning life silly asking meaning cup coffee believe life purpose meaning atheists find comfort time danger many ways obtaining comfort family friends even pets less spiritual level food drink tv may sound rather empty vulnerable way face danger individuals believe things comforting face reality matter harsh might end decision individual concerned atheists unable believe something would otherwise believe merely makes feel comfortable put truth comfort consider searching truth sometimes makes feel unhappy hard luck nt atheists worry might suddenly shown wrong short answer many atheists atheists years encountered many arguments much supposed evidence existence god found invalid inconclusive thousands years religious belief nt resulted good proof existence god atheists therefore tend feel unlikely proved wrong immediate future stop worrying theists question beliefs nt arguments apply beliefs questioned similar weak atheism sceptical default position take asserts nothing strong atheism negative belief theism strong positive belief atheists sometimes also argue theists question beliefs real harm cause believers everyone else sort harm religion represents huge financial work burden mankind matter religious believers wasting money church buildings think time effort spent building churches praying imagine effort could better spent many theists believe miracle healing plenty instances ill people healed priest ceasing take medicines prescribed doctors dying result theists died refused blood transfusions religious grounds arguable catholic church opposition birth control condoms particular increasing problem overpopulation many thirdworld countries contributing spread aids worldwide religious believers known murder children rather allow children become atheists marry someone different religion nt real believers claimed believers sort excuse makes real believer many one true religions hard tell look christianity many competing groups convinced true christians sometimes even fight kill atheist supposed decide real christian nt even major christian churches like catholic church church england ca nt decide amongst end atheists take pragmatic view decide anyone calls christian uses christian belief dogma justify actions considered christian maybe christians perverting christian teaching ends surely bible readily used support unchristian acts ca nt much moral code bible word god could nt made less easy misinterpret know beliefs nt perversion god intended single unambiguous interpretation bible atheist take one interpretation another sayso sorry someone claims believes jesus murdered others jesus bible told must call christian obviously extreme sorts beliefs questioned since nobody ever proved god exist must unlikely basic religious beliefs shared faiths nonsense hold pointed start dialogue positive assertions concerning existence entities inherently much harder disprove negative ones nobody ever proved unicorns nt exist nt make unlikely myths therefore much valid hold negative assertion default hold positive assertion default course weak atheists would argue asserting nothing better still well atheism great many theists unfortunately popularity belief little correct whether works consider many people believe astrology graphology pseudosciences many atheists feel simply human weakness want believe gods certainly many primitive human societies religion allows people deal phenomena adequately understand course religion industrialized world find people believing religious explanations phenomena even perfectly adequate natural explanations religion may started means attempting explain world nowadays serves purposes well many cultures developed religions surely must say something really religions superficially similar example worth remembering religions buddhism taoism lack sort concept god christian sense course religions quick denounce competing religions rather odd use one religion try justify another famous scientists philosophers concluded god exists every scientist philosopher believes god one besides already pointed truth belief determined many people believe also important realize atheists view famous scientists philosophers way theists view religious leaders famous scientist human may expert fields talks matters words carry special weight many respected scientists made look foolish speaking subjects lie outside fields expertise really saying widespread belief religion indicates nothing entirely certainly indicates religion question properties helped spread far theory memetics talks memes sets ideas propagate human minds analogy genes atheists view religions sets particularly successful parasitic memes spread encouraging hosts convert others memes avoid destruction discouraging believers questioning doctrine using peer pressure keep onetime believers admitting mistaken religious memes even encourage hosts destroy hosts controlled memes course memetic view particular virtue associated successful propagation meme religion good thing number people believe disease good thing number people caught even religion entirely true least puts across important messages fundamental messages atheism many important ideas atheists promote following nt surprised see ideas also present religions moral behaviour mindlessly following rules especially sceptical positive claims want life sort meaning find search true even makes uncomfortable make life probably one good relying external power change must change something popular nt mean good must assume something assume something easy test nt believe things want true finally importantly beliefs open question thanks taking time read article mathew begin pgp signature version end pgp signature information pgp send mail pgpinfo mantiscouk'"
      ]
     },
     "execution_count": 141,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_text[1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "metadata": {},
   "outputs": [],
   "source": [
    "def clean_text(text):\n",
    "    # split into words\n",
    "    tokens = word_tokenize(text)\n",
    "    # convert to lower case\n",
    "    tokens = [w.lower() for w in tokens]\n",
    "    # remove punctuation from each word\n",
    "    table = str.maketrans('', '', string.punctuation)\n",
    "    stripped = [w.translate(table) for w in tokens]\n",
    "    # # remove remaining tokens that are not alphabetic\n",
    "    words = [word for word in stripped if word.isalpha()]\n",
    "    # # filter out stop words\n",
    "    from nltk.corpus import stopwords\n",
    "    stop_words = set(stopwords.words('english'))\n",
    "    words = [w for w in words if not w in stop_words]\n",
    "    words = ' '.join(words)\n",
    "    return words"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[nltk_data] Downloading package punkt to /home/jovyan/nltk_data...\n",
      "[nltk_data]   Unzipping tokenizers/punkt.zip.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 114,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import nltk\n",
    "nltk.download('punkt')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.collections.PathCollection at 0x7fcbef531be0>"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAXkAAAD4CAYAAAAJmJb0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO2df3Ac5Znnv8+MW2TkDYwUTAKDhYyPmMMxlhIHxOr2NpAfTnAwEy/YEPuK281BXSqbXQOrRAousLN2rKw2xqm629oiyW1lDwMy4EzsmMQEnN2q9cUmBsloDfGC8c/BCU5skcQa8Fh67o+eHvf0dM+v7p5+e+b5VLkszYymX41mnn76eb/P9yFmhiAIgtCYRIJegCAIguAfEuQFQRAaGAnygiAIDYwEeUEQhAZGgrwgCEIDMy3oBZi5+OKLubOzM+hlCIIghIoXX3zxN8w8w+4+pYJ8Z2cn9u7dG/QyBEEQQgURHXG6T8o1giAIDYwEeUEQhAZGgrwgCEIDI0FeEAShgZEgLwiC0MAopa4RBL9IjaQxtOMA3hzP4LJ4DH0L5yDZnQh6WYLgOxLkhYYnNZJG31P7kJ3UHVfT4xn0PbUPAGwD/fLv/By7Dp4quC0e07B68Vw5MQihg1SyGl6wYAGLTl7wmu6vP4vTE1nb+xK5rB4A1mzb7/g4gxU9HVibnOf5GgXBDUT0IjMvsLtPMnmhYbAryQAoGbjT4xmsHB6t+BiP7j6KH7yUxsTZSSn7CKFAgrzQEKRG0hjYMoZMdhJAriTz5D5M+XCsM2cLjwHYl30EQQUkyAuhxsje0+OZovuyU/6XIrNTjNVb90uQF5RFgrwQWqwbqkExnildxxeEIBGdvBBKUiNp3Ds8GniAN0iNpINegiDYIkFeCB1GBq9GeNcZ2nEg6CUIgi0S5IXQMbTjgDIZvIHdnoAgqIAEeSF0vCkBVRAqRoK8EDoui8eCXoItUpcXVESCvBA6+hbOgRaloJdRhNTlBRWRIC+EjmR3AkO3zUdbq5a/LR7TsHFZF6IUXPCXurygIp7o5IkoDuC7AD4EgAH8BYADAIYBdAI4DGApM5/24niCkOxO2DYgVWNRUAotSlVv7gZ5ghEEJ7zK5L8N4CfMfDWA+QBeBdAP4HlmvgrA87nvBcFXvAq0tah3JhUy+xMEA9dBnoguBPBfAXwPAJj5LDOPA7gVwPdzD/s+gKTbYwlCOe68fmZgx04ouiEsNDdeZPJXAjgJ4J+IaISIvktE0wG8n5lPAEDu/0vsfpiI7iGivUS09+TJkx4sR2hm1ibnYUVPR91LJzEtmne9FASVcO0nT0QLAOwG0MvMe4jo2wB+B+DLzBw3Pe40M7eVei7xkxf8ondwp28bo+aBIjKBSgiCUn7yXmTyxwEcZ+Y9ue+fAvBhAL8moktzC7gUwFseHEsQaqJv4RzEtKgvzz39gmlIdiewKjWGlcOjSI9nwDhvRSz6eSFIXAd5Zv4VgGNEZFyrfhzAKwC2Argrd9tdAH7o9liCUCvJ7gTWL/FnotOb4xmkRtJ4dPfRovsMK2JBCAqvrIa/DGATEbUAeAPAn0M/gWwmoi8AOArgdo+OVXfkEjyc2P3dEvGY52Wby+Kxko1QYkUsBInMeC1DaiSNvif3OQ6gMOqxAOREoBDWSVEGV10yHa+/dabuDpaHBxcVfC+Jg+AlMuPVBau37i85YWg8k8XK4VFECDAelh7PYGDLGAAZCxcUQzsOFAV4AHjtrTN1X4u5MxewH1Uo7xfBL8TWoAyVXmpbzwOZ7CTu37wPs/q3o3dwp2y+1ZlqnCq1CIq8cLwUYD50y9z818bmrPUElMlOiveN4AsS5H1kkjmvshjYMiaBvo5U41R5bgoYum0+EvEYCHrm/R7Nm49GqxbJZ+erUmO2m7MGYqEs+IGUayykRtJYs20/Tk94u1lmZGpyOV4fbrx6RsmAaoahe97EYxpaW6Ke/u1bpumyTSf1jRlVLZSFcCNB3oTfg6HFpdB/VqXG8Nieo0Xls0rwQwUznsnma/DlkI5ZwQ9EXYPzSod6BOEVPR1Ym/RHr93slCuHBEWlsk2CflWRELWNUCWl1DVNG+RXpcbw+J5jdXcOJAAPL+uSD7APzB54RkknSCN414I14Iv0UrBDgryFoDM+Il1fPz6RlQ+qh3T2bw96CUVECLjwPZqrUhABWN7TgQVXtBdp/2NaFOuXzJOTQJPT9EHe+sZ/8+0MFPq1iz6otSAfbnUz+ektUZw5W6zZrwYCEG/VHDeF21o1/OGdLLJThbd78d4S1MdvgzKlMTa9zKZRqsWBTHYSa7bV7m9i9zs2o2QzSC/5UrgN8IBe7iml+jk9URzgAdHfC02grnHqfFSN0xO6CqNcxmXO2N+jRfBOdsq23pvJTuZH4TVLFmdsaKu4+Rokor9vbho+yIfpDV5OR29th8/YpW4W7tvc+IHeWqpSjXjMXU3eLSq+JkL9aPggf5kProN+Ue6EVMtVyRQDa7btx+qt+/OBpq1Vw0O3zG2IwG/nA6MaZ89NIqZFKjop+4Ho75ubhg/yfQvn2LoRqog147JmqLUGMGst9/REFvc/uQ+rt+7H25lwK3zWbNuv/N92IqDgbhDGv6vgHQ0f5I03eL2anWqFoGehvYM785mXnxnq5BTnM/v0eAYrh0ex98ipUDVqpUbSnttPNBr1nXQrqEjDB3lAD/TJ7oSvcz7dYG6WMQJuEDy6+ygWXNEemsxPVCPlWd7TEfQShIBpeAmlGRU3YaNUezekH4QpcKr491SJqy6ZHqorM8EfGjqTt5pVqXbp+v73tuDXvz8b9DIKUPFKx4kwbarXkygR7rx+pgR4AYCHQZ6IogD2Akgz82eJqB3AMIBOAIcBLGXm014drxx21gUqZcwA8Pt3zgW9BFs6+7eHwiSrb+GckqMZmwnreEFBMPAyk/9rAK8CuDD3fT+A55l5kIj6c99/1cPjleTxPcfqdaiaCVp1UYowjKQz1mWWhzYj8dj58YJm4z3J6AXAI+8aIrocwPcBrANwXy6TPwDgY8x8goguBfAvzFxSsOuld005syoiKGdvoCphyOrN1MuorNYmp5Yo4axHMwsiADbkXE2djPfE3rrxqYd3zUYAXwFgTk3fz8wnACD3/yUOi7uHiPYS0d6TJ096tBy9LlkKCfCVkx7PoO+pfU3nhVOKRDyGt6sM8Il4DL2z2z0bSqNFzgd4wPnqNQxXtYJ/uA7yRPRZAG8x84u1/DwzP8LMC5h5wYwZM9wuJ4+qZlVhJTvJrkzU6kU9TkQxLYq+hXOqsgtoa9XQt3AO/t/BU57tDWWngL1HTuW/d3LgVNGZU6gfXmTyvQAWE9FhAE8AuImIHgXw61yZBrn/3/LgWBWzNjkPK0QjXETv7Hb0zm6v6WfD0HjktwQ0EY/lrXv7Fs5BpELJ1umJLO7fvK9kgCcAF0yr7iP52J7z5Rmnq9dyV7VCY+M6yDPzADNfzsydAO4AsJOZVwDYCuCu3MPuAvBDt8eqlrXJedi4rAsxLVrvQyvLroOn8IvDdRM51Z1S2vmES6OuKBF29d9UsDfhJOxp1Yo/WqUy6kQ8huU9HXj3XPFmfKmT8hTrexCd/dsdn1+uapsbP5uhBgF8koheA/DJ3Pd1J9mdwPol85CIx5TTyQeFm00/1evyTiUUY/PYDdYgunqrc/kqk50qUL2Uo/N9Mcfa+a6Dp2xvL0eUSDZdheaYDGVm7oM/8WSIg6Cmm6XVlRIonI60/Ds/rzloJuIx7Oq/Kf+9iuMGDTbKHOGmoqknQ1lZ97l5iFZaSBVKcnoiq5zqxnrlZq6hA8Cmu2/Aip6OquvUhPOWvamRNLrWPOvxyr2lGSeDCfY0XSYP6B/SezePiozSI6wZLqC/xmu27c9v1sZjGlYvVivrn9W/vWKly4rcIO0wNV7Z/V2ExqRUJt/Q3jVmVqXGsGnPUQnsPmDd7EyNpNH31L4CPfh4JqucnXGl3jfTW6L40b4ToRsrKAZuAtAk5RqjE1ACvD9YNzuHdhxwbPjZtPuoMmWEvoVzyiqvtCjh7Lmp0GTvZmTsnwA0SZCXjj//0KJUpFoplUEy1LEztqvfr+jpKPh+esu0UBqgGQ1bgtAU5Rrp+PMHJ3VNuTKISmUEY6CME7N8VNAQgD+e3V6R2sc8WKbc48I8zlHwnqYI8lEiCfQeQgAeLiHR61s4p+R0Ky/LCNY5uLUGN6fn8dOznlG5Br6Sd69o4gU7mkJd4+TO5wfRCGFS0ct7L0925ZQbpTTkXmm47TTxBtbftZTtbmokXeRLr0UIQ7fPB4BQDIJviRL+Y93NQS9DCIim18nX08dG1QDf1qrh4PqbPev6tSu5rEqNYfbAMyUDfFur5lkZYWjHAcfgaz2ZTTLj0d1HsSo1VvTY1Vv3F9Xds1OM1Vv329btNy7rytllqPPxOTvJymxoC2rRFOUaQA/0C65oD0VW5jValPDQLXMBeDcdy1pyqeRqKaZF8+vwglpq+5t2Hy3I5lMjaUfljHG7U93efFtqJI17h0cDnT6m+pAXIRjUSUXqgJOaoq21co+RsNASpfzvOHTb/PwH36nTk6CXKCrBTrlRTsEUJSroPK2V1Ega3V9/Fp1VNDKZYZz33zHKPV6Q7E7g4WVdFbtS+kEmO6mMcklQh6bJ5A3ssrK1yXlIjaRLbhaGjckp4JDN3M87r59pm3Evz3V09j05ilJTCZ0UNeVq/VPMVQd462bojVfPwOMvHHNdEluzbT+Gdhwou6FqnPxLbe5aO3uDRiXlkqAGTRfknUh2JxoryDsEXaNU4TQH1MnEi6CfCGpVbxjlHbuACaDotr1HTmHT7qP5bD09nvFs8/z0RLaioPzQLXOLNneNKVmq2htIA5RgpSnUNZUye+CZQKSWxrxZOy10rXNEo0Q4uL52tUW10sRaHRm1KAGMQmVLlDwbkeeGw4OL0Du40zcJpR+IjLI5Ee+aCum5sq1mG1o3XPQeDdMvmIb0eCYv/TMPz64l0LgdFFGuSchKokY9uV0wVyHAG4QpwAPA9pdPSJAXCmiqjddyHP5tMB/o8Uw2H0wmmfNWAUaQrcRjxdhPDWpQRKO10PfObkdqJF23QTOGCMDt8VTZG/CL1EgavYM7Mat/O3oHd4pstAIkkzehyqZVdpLxwA/G8kHe+N/YLIzQ+bFzqlj4JrsTSm1AuqF3djs23X0Degd31k0Suav/JqRG0tjy4nFMlNr5bmLs9kfuVczZVEVcB3kimgngnwF8AMAUgEeY+dtE1A5gGEAngMMAljKz0sNF/Wxhr5YzZyeRGkkXBPqgA3k5Hrplbk19CFqElDIB23T3DQDqd9KPEpkCmLsAX83IwbBh1/zG0HsfDp38A3a/cdpWTNDseFGuOQfgfmb+zwB6AHyJiK4B0A/geWa+CsDzue+Vpm/hHH0jsAxmLbTdwGavCJvm2ehDqLTkQNA3Codun1/1pKZ6UIlSRYvoNg2HBxfV3FV95/UzS3bvVooWIaxe7F2zmWo4nXQNDyBDNGF0N8998CdSzoEHQZ6ZTzDzS7mvfw/gVQAJALcC+H7uYd8HkHR7LL9JdicwdNv8ks1RMS2KDUv1D/XhwUXo7oj7tp70eCZ0tUejKcipscqI5Yl4DA8v68LapN4gNaWIysv8t7/x6hklH9s7ux2vfWNR/grLsM+o9oS1NjnPk6uGZdfNLLraq7SGrXKt22iAq/YdcubsJFYOj6KzfzuWf+fnvqwtDHhakyeiTgDdAPYAeD8znwD0EwERXeLlsfzCWhYpJyX0W43DyGmzn9yXX5/qmPcQKpVgqlAqi0Yor40vpYPXolTQRQyUfp+UUkclclcLF9UolTXz6O6j2PPGb/HGyQlMMueluQbW95GxZuvajF4A43FBYjdlrBZ2HTxVIPONaRGsX3Jt4L9fPfBMJ09EfwTgXwGsY+YtRDTOzHHT/aeZuc3m5+4BcA8AdHR0fOTIkSOerKde1KoPr4V4TMPoQ5+q2/HqSSlHyXoS0yI4O8llu2rNLpx2LpbAec26U6AyO116EciqpZxHfVurhpEHg32/+dmnEAGwIeeIaj5JXxTTkJ2cwpmz+ntRFXFDKXzXyRORBuBpAJuYeUvu5l8T0aW5LP5SAG/Z/SwzPwLgEUBvhvJiPWGkrVUDM0pmcyp2WHqFNfuPV/B6+EGlG5/mwGPnYgnomfWCK9rzv5vTYPPewZ2B9AaUO6IKSik/N7+noP/trFYe1vfceCaL+3Ld8CoHeie8UNcQgO8BeJWZN5ju2grgLgCDuf9/6PZYKtJb4WSfUhCQz5jqeWWgGnYKou6vP6tEsLFirruXOhENbHk5/3s5BYigy1Qq43cZr9IkwjghNGWQB9AL4L8BGCMiw/zla9CD+2Yi+gKAowBu9+BYyrHp7htsvV6qwaziKDXYoxHdMsuhYoAHdAVHZ/92XDCttHYhk53KS2FXpcYK/HgA5DdqVZxcFpQcMzWSxgM/GMuXS1QhrFfSroM8M/8b4Kia+7jb5w8Dhq7awKlG2zu7HS8dfbug7my17XVyiSTAUy92wRvePVe+vLNm237sPXLK9u9ar4ll1RIh2Moxra6bXterUyNp3P/kPmWH74QR6Xj1gVLqknJqHaOBY9Oeo3llRKsWwTcUVgKsSo05ulq6pVaDNpU4PZEt67evEk520nYBeDyTxcrhUTy592hRsmOm0vfI0I4Dygb4sF5Jiwul4AqniVBXXTIdP73vYyV/rpIPfWokjfs2j0LRz31DUW5ub7n9ESfPJKf3iN3jZ9U4DMZv7GSzKtH0M14F/3hsj3254bW3zqCzfzs6+7eja82zBc01xofe2qFoN3812Z3AhqVdBVlUPKbVbWavF8RjWt2MztxQTslSbn/E6WqlmttV8MOPQO9iNk+QUznAl0PKNYIjlUxEqiTDHs9kC5pwSn3o7TJBJ2WKqvVsK6sXz8VXn365ovp9LWgRQsu0SNmNSqN+7tToZR3sYla1VNLFO8lc4Ldkvt3p8WY1WVurhpYKbEX8ZgrA3iOnHK9qqp21EDRSrvERP2vVfmPXnGQ0z8RjGs6cPVe1ttsoB5SSiR62GVnoRFBDXqqlrVXzXCWUiMcKxyLm3meVrGXRtZfi6RfTRQKA9UvmFU3kqhbjeczJQFgnrhFgm9xYB7YTgIdzTVVBIUNDAsBahzRKEgBCEejXbNtv6/gH1C4lM8oBTpLBaj1fghryUg0Ef2Sg5o38gS1jFZ/sTk9k8fgLx3DndTPxs1+eLBrD6CbAA+eHie89cqpAPBBGDEuRlcOjJU9UDOArT+1TNpuXIO8T1ZYkVEEPGi+7try1wygHOMlEe65sQ+/gzoovg4Ma8lINfsW4oR0HdEO9GtwrJ6cY218+UWRZ4JV/vpfzeMPC2UnGrP7tSpZvJMj7RKk6pIpY9c9eo0Uony3mZaKWrNGclafHMxjYom/EOn1gVBnyEgTp8YyrcpXd37mZX08vsGb+qpRoRV3jE06lh3r5pldjMdv99WexcnjUtwBPAIZuL1QnLLiiHREHO2ID49LfCRWUGEHidcJQyetZ5k8mmDBKtJ/c8C+BrkOCvE84DdJ2O2C7Eow6bXo8k88uBraMFQX6Vakx3OtjcDcwb0oZJ5+Vw6MVNb2Uyi4rmX0rVE6p19OYHbxhaVedVxV+XnvrjK08uF5IucYnjEu0INQ1dnXaTHYyfxlpKCzcbrJVijnAV2snHMmNxrMr2Vhn3wqVY9e9WekcAHm9q+fR3UexaffRQGr2IqFsQFTqGowQsGFpV95St5bgYMjyAOcApPsFFVrGNhKJeAxvvp3xVK3S1qrhmkvfW/VsVFW8/8OKMUfAy0BfSkIpQb6BMOvyVcII0lZ9cTW0tWp4Jztlq+0GgPuGR9Gg8R2AbgFQL8WKkz2BGXNDkFrvtnDhlcGb6OQbGKcRbiqRyU7igR+MuQoGdvsGmewk1mzbj3eykw0d4IH6dvdah504MT5xVgK8S6zd4H4gQT7EhOmy2S9vcFX95sNOqcBTTztgLUqYFiFP+jbKjTsMiuwU497N/k2eEnVNiLHrShUEL8hOsaN8tZQdcJQIhwcX5f+5ZXrLNKxfcq3r54nHNCUDvAGzfmJ1kjq7QYJ8SEmNpCWLFXzFSb5aStZq3Q9y68H+diaLZHcCmotIFYFuEpdQvK+i1InVDVKuCSl+vBkEwYxTc1SpuasRArrWPJv3N2p1E50BtLbouv2h27tqniswBbja9K8nfuyt+Z7JE9GniegAEb1ORP1+H69ZkBZ0wU/MNhRW+hbOcex8neJCA7sJh1q6VqGl8ERuL8eYK1Brx3gYAryB1yUbX4M8EUUB/G8AnwFwDYA7iegaP4/ZLDR7S78TxqAHoXKsyXY8ppXXcdtEzXJJe1urVjCEo5Lyifkwye4EvrV0fsN3Ofc95W1t3u9yzXUAXmfmNwCAiJ4AcCuAV3w+bsPTt3BOaC5B60l6PONrkG/VIo7ZaRghANkplG2EqkSqW+5laW2ZVuR8WU4dZs3c7bpyVZYP10J2kvMuo17gd5BPADB77h4HcL35AUR0D4B7AKCjIzwj3YIm2Z3A3iOnms7StRL8PPE1QoBP5AaNPGqytSg172BVaswTCwxridEIYqXcT+28nqyTwmrtpFYZL8uxftfk7ZKqgvcKMz/CzAuYecGMGTN8Xo4gBMOFF6hRYohpUfQtnOM47+DR3UfzpYLUSBpzH/xJwcnADXYlxmR3AiMPfgobl3UVlXt6Z7dX5PXUiEZ1XpZj/Q7yxwGYT8WXA3jT52M2DZschmgL6pCIx7BxWRfeG2sJeik5zg9Pd2JgyxhWpcbQ99Q+T5vYOt/nHLj2HjkF6wjcl46+XVFtOtmdyNtbNAJa1HnTuxZ89a4homkA/gPAxwGkAfwCwOeZeb/d48W7pjpKzUoVgsfsAaOSaZwWIWTr0K1qx8ZlulWxuaZ+49UzHMtBxlzgSoZnN0LZptZ5saW8a3zN5Jn5HIC/BLADwKsANjsFeEFoNIZ/cSyfiaqkhgoqwAN6/d0666BUOSg9nql4PkIjlG0Y3lsb+K6TZ+ZnmPmDzDybmdf5fTxBUIXsJGPNNj2n6Vs4R6Sd0L2GqrHiIACrtxbbd9hNDTPKNoY0s15T2FRHOl5DTDymFTSeCOpxeiKbL6tFCZhUpWYTEhhwfI8bCpRSpZywlXDc2kDYId41IWb14rlBL0FJVM3fJMB7y2XxmD4s5ql9BaUcczORXQlH1ZJONEJ46BbvP9NNHeRXpcYwe+AZdPZvx+yBZwKdw1gL9RwhFiYklnqLiidNQwq6Ztt+ZC1nT3OZzFzCMbptVVTiTG+J4lseT4syaNpyzarUWEEjkV0zSCU7+kETJVJuEpTQWKj27jKauUo1UZlvt3bJDu04gAihJrMzr/FqMlQpmjbIOzWDPL7nGNYm5xUN5DB29AG1Mug7r58pXa+CrxgbmSrUtgl6CabvqX1FGbyVzv7tiBKh58o2vHT07YLPclAlDAKwvILxil7StEHeKfs1bh/accBxR1+lIG+8WSTQC36gRQln3j2nzAb/ZfEYhnYcKBvgDSaZsevgqaLbgzCnqGR2rh80bZAvRy0DE4JibXIeFlzRHppRgEJ4yE6yMgHeyOLvHR71/LljWgTvZKdsy7JezFFua9UCCfBAA2+8pkbS6B3ciVn929E7uLNq606n5hUGsPw7P/dghd6S7E7gzz6SKNgkixLyvt9RIvTObldWWSAI5Vje04Fkd8KXxrJMdgoM4My75wpuN+/L1Yrmk2qmUhoyk0+NpNH35L58Z196PFMwmDg1knbcsEzkZFnWP7aZXQdP4cr+7flLvrZWDQ/dUtnmSSWbubVs+KZG0nhsT2HnoHFFa75MXP6dn9tevgpCvTE2UId/cayg/BKNEFqi54d3Wz9fldbka2E8k8XK4VGs9PBqoaw3v8/46l1TLV5416RG0o4+6/GYhrmXvbdskKt1qvtGG88Jc8C+KKbhd+9kC3b1IwAuatUwPpHN+3g8/WK6oOwS06JYv2ReyTdK99efdVQamP0wZg88I2ocB6JE+MBF76nbBqPZm55IH+bcKEQIIKKigd8RAjYs7bIth1Sb1Ny7eTQUr5kXA83LUcq7pqGCvFURU2+0CPDaN87/QWtZj9MJxjBqcqKcWZnx82Jq5syKng4suKLd0yyuUmpNLFRkeksU6z6nXzmaZY5eywVVMn1zggAcCjjIN1S5xk4RU0+yU7r+3iiN1LIepzet2w1f4+e91tW3tWpgdm49t8O4sjBnb6UUHPWwbzB7lwcR5FUPVgal9OV2ZUs/yxRhmAq1vCf4QUgNtfGqgvJlk2nogpfrKbfZFI+V9ryIECE1kradtOOG8YksRh/6FFb0dDgOd7ZyWTyGZHcCu/pvwqHBRdjVfxNWL55r236+cVlX/vn97Lx85cTvfXz2xiAe07BhaVdB9+jGZV04PLgIhwcXYeTBT9W19uyl57ofBCWZtNJQmbwKZ3YG8lp6L9dz49Wlp2atXjy3YLPZyiQz7h0exfKeDqzo6fBknBtw3j9k+BfHKuogNNrRrdjN7jTXZg2ZqF9Ztnk/I6ZF8pt+wnnezmSLRu/Vk1WpMTy+5xgmmfMzadtaNce9qCBJxGNKBHigwTJ5Vc7sRgbvpb3sj/adKHl/sjuBodvn57sT7WDoVxoLrmjHocFFWNHTkbdjNSSWrdYZbGVobYlg5fCoo9KhrVUr8g1xChLW7N76uHoEl9RIWgK8A0F64hs2JEap0bAhUTHAA2pUFQwaauMVUGMzxrxJ6uVGZzW79OVeh0QJFYMXzR8G5o0nL7yA/JKAqr7xmQj4KrUShZefqPC5roZyQgmvaZqNVwD449ntgevAzaUVLz+cXWuezW9AltPmlysVpcczRXpg83Ma/QRu9chG9lfKCwhwLtNY2XT3Dbjqa9vhdbKtcgAxTshBqX6CNudLjaSV+/toUXL8XERInaoC0ICZfCm9eL0wn8VTI2nfPpxalDB0m32jRal+gVJYdcypkTTu37yvZkWOsfnkNLyhrVXD7945V6SnNt9vPZlZm90E/6iHxrscqg3+aNUi+Is5+eoAABbcSURBVMaSawEAX9vycr7XwXxfvU+IvmXyRDQE4BYAZwEcBPDnzDyeu28AwBcATAL4K2be4eZYlRJ0gAcK63HJ7oRvQT47yY6GacnuBPYeOVX1BusU6+PWjOd0u/7hXxzDgivaHWuU5f5epyey6HvqfLey8X8pm1nVaIkSzoZwYkip/Z16olJ926qYUcms0Am35ZqfAhhg5nNE9E0AAwC+SkTXALgDwFwAlwF4jog+yMy+itir9afxC+sGlZ/11FIfAEORUm0mbtWku9HWZycZ92/eh9aWKM6cre3Pb5zMAHi2V1APtCjhus62wMuHteCkggqCoFVzQdgDe4mrIM/Mz5q+3Q3gttzXtwJ4gpnfBXCIiF4HcB0AX5y9UiNpPPCDsZqDiNekxzMFG64xLYJopLjF2wvKKR6S3QnXrn1um6cmmV3/bdLjmZrKT4Degel0/KsumY7jp9/xpInOqF+b9xbu37zP9fPWm1Kb8kHgp1dNOeq9geoHXm68/gWA4dzXCehB3+B47rYiiOgeAPcAQEdH9d1hqZE07n9yny8B1Csy2SlEUDrY1IIWJdx49Qz0Du4suWlZbSZkHSYctLLDoNa/8LrP6aoQqzKnd3Y7Nt19Q9GUMDfrswaEIDZLa6VeLfjVYryfrRYJfndBq3Q144ayQZ6IngPwAZu7HmDmH+Ye8wCAcwA2GT9m83jbzygzPwLgEUDfeK1gzQWs2bZf6QBvMAWAc00cXtkKZCe5IDg5Ta+qJhOyGyYclLLDK+7brK9909032N7/s1+e9OxYqZF0wWsfpvGMEdKlikGraeywa8LyakO2VYvglb/9TCjGfdZC2c4XZv4EM3/I5p8R4O8C8FkAy/m8VOc4AHP//OUA3vR68YAaG62VMpGdqukDTyZf+HIY06vMJLsTGLptfkGGTpb/AT2DtxsmnOxOlLVNUJkp1lUQTni5sTdgOY7XNhJ+Msl6JmYkC6rscTnRt3CO6/kIESCvlCnXjBdW3KprPg3gqwD+lJknTHdtBfAYEW2AvvF6FYAX3ByrWanF/tYuaLltR1+9eK6y2XxMi+LPPpLA0y8ed+xWnSghrPdyYy+TnSrI5qsZz1iPEkSlqDjq0orVCqPa9KkeQ7RVwK2twf8C8F4APyWiUSL6RwBg5v0ANgN4BcBPAHzJb2VNozLJXHUA8qP9PNmdwPQWNadKrV8yD2uT89A+/YKaft7ruuvK4dGCaWRrk/MqkiPOvey9nq7DLSpJF50wZ9+VsqKnA4cHF2H0ofoaqgWFqyDPzP+JmWcyc1fu3/803beOmWcz8xxm/rH7pdpTaRkjSKq0g3GFMQfTD9Z9bh6iCr/gpYISlVi2Hycwa8mjktKCalLLIL1q/EKLILRSyFoJvUHZ568P3q/ZiZYogQDPW/CdMPS8fmUnye4EvnX7fOVOrMYeRKmgtLzM+8SPE5h5fyTZncD6JeUzelVe2jAqS6yqMCsRAoZu76rTatQh9EG+3mfljcu6sKKCQQC9s9txdpLr5rmRiMfw8LIu31+PZHdCuZFrRjnLKVs2DwRxwjiBmQNFPKa5PqFZu5939d9U0iqAgUDLYpW4harKQ7fMhRa1/4Ml4rGisYPNQkMYlNXL/9t4A2158XjZx/p16d3WqmHkwU/58tyVEnQHoh3WiVy1yODsNqfdauidri6cpJVRIqz73LxAxlgafQNhpdxMgmalIQzKUiNp3Dc8inpURVRoDDKbdqVG0li9dX/F7pReEPQsXTuiRDi4/mZfnrtWu+hS9rxOJw/DG8Vs9+y1DbLdCL+wB/hmp+Gthu3O4H4F4qADPHDetGvvkVMYfuFYgRujnaGX11hf74gCDT9+Hn9FT0fV2Xw5awDjqsM66ci43XxVYW7ScftblnIuFRqThsjk7fByWEcYqdRzw4suv3pl9qWuovzM5AE98zY7ekZJbx5ywi+L3tkDz9R8QlPNk0bwjobP5O1QqbEkCMpdcVjLPMbP2NkilMN4rBvf+XIYJy2nMoffnaVrk/OKNm8/ueFf8NpbZ4oe2zu73bd13Hn9zKquKoKe6CQET+jVNU6sXjy3/IOalOXf+TlWDo/angTtbBEqIdmdwLeWzq+5zZxIL4tsXNZV9BxmOd/a5Lyi2bRWj+968dP7PlYU0P2ubRu/v1VD0taqYeOyLmxc1lXxTF2hOWjYcg3gnGk1C3Ylg0rUIm7cCKuZD+tUPmhUoyhB8IumLNcAwBsnJ8o/qMl4fM+xso9x0+loBONyPjelatZufXYEQThPw5ZrAH8VF6rT6uClUO418aLTsVy5R5WxcoLQDDR0kI+WMixpcJZ85PKi2yqxjr1gmvu3RDljqxuvnuH6GIIgVEZDB/kweXl7zdMvpouC+uqt+8v+3Hgm69pLvFy5x8shHYIglKahg7xViaEC8ZiugvAbO5VMpZLSWhU2Bn0L50ArYfoSBgtbQWgUGjrIA3qgP7j+ZhweXFQkL1vR01EyGPlBdnIq35FaKyt6Oso67gHugqmbn012JzB0+3xHR8VGtLAVBFVpaHWNFTvVxoIr2iuW/HmB20HexlXAY3vKN8RcFo9hVWos3zpfDW4DsfE6Wzthw2hhKwhhpqmCvB1G4O/++rOhmBc7sOXlihw3tQih832xmh0UvQjE4gooCMHT9EHeYDwEAR5AxZbK2Sl2ZXfsVSAWzbsgBIsnNXki+hsiYiK62HTbABG9TkQHiGihF8fxk4ti5WvczYQbdY0gCOrgOsgT0UwAnwRw1HTbNQDuADAXwKcB/AMRqTkFGnpAO3P2XNDLUIpK5JaCIKiPF5n8wwC+gsK5BrcCeIKZ32XmQwBeB3CdB8fyhaEdB5At5RvbhDSzg6cgNBKugjwRLQaQZmarJjABwGyScjx3m91z3ENEe4lo78mTwTTJiG5bEIRGpezGKxE9B+ADNnc9AOBrAOwGjtpJpG1TZWZ+BMAjgO5CWW49fqDizNKgqUSHLwiC+pTN5Jn5E8z8Ies/AG8AmAVgHxEdBnA5gJeI6APQM3ezp8DlAN70fvne0LdwTs0+6I3KomsvDXoJgiB4QM3lGmYeY+ZLmLmTmTuhB/YPM/OvAGwFcAcRXUBEswBcBeAFT1bsA8nuBNYvmZfvhm1r1VDnRljlEH8ZQWgMfNHJM/N+ItoM4BUA5wB8iZn9HQDqEqueOzWSxppt+0PRIFWKtlatpt9B9ikEoTHwLMjnsnnz9+sArPPq+euNEfTdDE4OGgIw8uCnahpqHpeafB6zNUSUCHdePzOQcYOCUAvS8VqGsAZ4wJ3/zNuZLFIj6aboVi0VxK3jEieZ8ejuo3h099GC8YUyslBQlYae8eoFYc3kCcDDOTOze4dH7aVNZWhr1TDyoJ14qnFwmnkbJeDCWPlSlxYhtEyLFBnPxbSoDNEW6kapGa8NbzXsljAOHiEAy3s6AAB9T+2rKcADwOmJLHoHdza0xYHTzNtJRkV7GdkptnUWdevJLwheIeWaMqxNzsOhk39wZfZVLVddMh0TZ6dq0u7HYxo+O/9S/OyXJ2t2oDSTHs9gYMsYAO9My1TCz6s06b0QVECCfAVsuvuGgpprvFXDO9nJih0hnWjVInjlbz/jeH/v4E7HQBEh4PPXd+BnvzxZUAcGij3c3WJkpSoEea9r31EiXwP9qtSYbNIKgSI1eRekRtJYvXV/zT4vBODQ4KKSz28XsGNaBOuXXGsb3EqdGNxQbq1+YA3orS0RvPbWGdvH1qp6carJe0WUCAfX3+zb8wsCULomL5m8CwyZpRGM0uMZEAGVnjfLqV9qGbrhl769niP7VqXG8Nieo5gyvY7lTlyG6uXQyT/g8G8z+SsuZt1szcjYE5bXcG1yHoZfOAqXF2Ul1yUIQSJB3gOcBmMUBH8UmvdUOgav2qEbfvjw1HNkn9vM2rx3Yt44NYKt3R7D0O1duG94FH7E+SZvnBYUQNQ1PpLsTmBX/004PLgID1uGiPslr/PChydC+gau32u1w0nt4iVW5UuyO4HP59RIXtPaIp5IQrBIJl8n6jUGzzhGrXsFQeu761XeSI9nMKt/e74E9qN9J3w5zoTLwe2C4BYJ8g2Ida+gVH36xqtnFCl06h3gzeusJ4zz5Rsv1Uhm6rmXIQh2SJBvYMIwRNtJQVRP/Dp2PfcyBMEJqckLgTK040CgAd4v4jFNbA0EJZBMXggUVSyNq5G+lqN3djs23X2DN08mCC6RTF4IFFVq1l7u9+46eKqh/X6EcCFBXgiUcpLPsE7oEnMyQRUkyAuBYh29GI9paGs9r9HfsLQL00OoNVelDCUIrmvyRPRlAH8Jfczfdmb+Su72AQBfADAJ4K+YeYfbYwmNSSUqoJXDo3VajTeoUoYSBFeZPBHdCOBWANcy81wAf5+7/RoAdwCYC+DTAP6BiMKXjglKkOxOIKaF66JTpJOCKrj95HwRwCAzvwsAzPxW7vZbATzBzO8y8yEArwO4zuWxhCbm8rbwZMYrejpEOikog9sg/0EAf0JEe4joX4noo7nbEwDMJiTHc7cJQk04WQyrRDymYeOyLvGPF5SibE2eiJ4D8AGbux7I/XwbgB4AHwWwmYiuhL35nq1IjYjuAXAPAHR0+GMSJaiD1YO/rVXDQ7fMbYjMd/oF0xri9xAai7JBnpk/4XQfEX0RwBbWJ4+8QERTAC6Gnrmbh6NeDuBNh+d/BMAjgD40pPKlC2EjNZJG35P7kDUZxZ+eyGLl8ChWDo8Web2HDVHUCCritlyTAnATABDRBwG0APgNgK0A7iCiC4hoFoCrALzg8lhCyBnacaAgwFtJj2ewcngUq1JjRfddME39jVcGGn7wuRA+3H5y/g+AK4no3wE8AeAu1tkPYDOAVwD8BMCXmLnxDEqEqqg0031099GiQPnNP7s2FI1RhqulBHpBFVwFeWY+y8wrmPlDzPxhZt5pum8dM89m5jnM/GP3SxXCTjXa8b4nC3Xxye4ENizVB6+ojnUoiSAEifrXwELDUI12PDsFdPZvR2f/dsweeAarUmP5SVthID2ekWxeUAJxoRTqRrI7gSf3Hi2Yw1oJ1iHdYcE6S1YQgkAyeaGubLr7BvTObq/pZ3cdPOX5kHI/yWQnsWbb/qCXITQ5EuSFurPp7huwcVlX0MuoC6cnslK2EQJFgrwQCM1UwpBNWCFIJMgLgRGPaZ48T1urN8/jF9IkJQSJBHkhMFYvnuuJ9n18Iqt0oBfbYSFIJMgLgWFo31td2ggzgDPvnvNmUR6jRUlsh4VAkSAvBEqyO4FX/vYzrjdiz06qZ3sUIWDotvlNtf8gqIcEeUEJkt2JUHSzVkpMi2LD0i4J8ELgSJAXlKHcUO+wkIjHsH7JPAnwghJIx6ugDEZQHNpxAG+OZ+wHECgOAaGxXhCaAwnyglKYh3rPGtgODlmkFyWNoBpSrhGUJWwBPqZFRUkjKIcEeUFZwrQRK3V4QVUkyAvK0rdwDrSo+pNC2lo17Oq/SQK8oCQS5AVlSXYnMHTb/KJuViPsJ+Ix141UXvDQLXODXoIgOCIbr4LSmDdi7UiNpLFyeNTxfjMrejqw/eUTOD2R9Wp5WNHTIRm8oDSu0iAi6iKi3UQ0SkR7ieg6030DRPQ6ER0gooXulyoIxSS7E1jR0wG7oo7hi5OIx7BxWRfWJufhoVvmeqLFjxDyzykIKuM2k/87AGuY+cdEdHPu+48R0TUA7gAwF8BlAJ4jog/KMG/BD9Ym52HBFe15ff1l8Rj6Fs6xzbCtWvzL4jGcOvMuMtmpio8X06KyySqEBrdBngFcmPv6IgBv5r6+FcATzPwugENE9DqA6wD83OXxBMGWcmWdUo9NjaRx3/AonMJ87+x2HP5tpuwJRBBUxG2QXwlgBxH9PfTSzx/nbk8A2G163PHcbUUQ0T0A7gGAjo4Ol8sRhOoxAvbAlpcLMvpWLYJvLLlWAroQasoGeSJ6DsAHbO56AMDHAdzLzE8T0VIA3wPwCcC2RGrb2sLMjwB4BAAWLFgQsvYXoVGo5kpAEMJE2SDPzJ9wuo+I/hnAX+e+fRLAd3NfHwcw0/TQy3G+lCMIgiDUCbci4zcB/Gnu65sAvJb7eiuAO4joAiKaBeAqAC+4PJYgCIJQJW5r8ncD+DYRTQPwDnK1dWbeT0SbAbwC4ByAL4myRhAEof64CvLM/G8APuJw3zoA69w8vyAIguCO4HvCBUEQBN8gVsjPlYhOAjgS0OEvBvCbgI5dCbI+d8j63CHrc4ff67uCmWfY3aFUkA8SItrLzAuCXocTsj53yPrcIetzR5Drk3KNIAhCAyNBXhAEoYGRIH+eR4JeQBlkfe6Q9blD1ueOwNYnNXlBEIQGRjJ5QRCEBkaCvCAIQgPT9EGeiL6cm161n4j+znS7MpOtiOhviIiJ6GKV1kdEQ0T0SyJ6mYh+QERxldaXW8enc2t4nYj6g1qHaT0ziehnRPRq7j3317nb24nop0T0Wu7/toDXGSWiESL6kWrrI6I4ET2Ve++9SkQ3KLa+e3N/238noseJ6D2Bro+Zm/YfgBsBPAfggtz3l+T+vwbAPgAXAJgF4CCAaEBrnAlgB/QmsYtVWh+ATwGYlvv6mwC+qdj6orljXwmgJbemawJ+z10K4MO5r98L4D9yr9ffAejP3d5vvJYBrvM+AI8B+FHue2XWB+D7AP5H7usWAHFV1gd9bsYhALHc95sB/Pcg19fsmfwXAQyyPsEKzPxW7vb8ZCtmPgTAmGwVBA8D+AoK/fiVWB8zP8vM53Lf7oZuKa3M+nLHfJ2Z32DmswCeyK0tMJj5BDO/lPv69wBehR4YboUevJD7PxnMCgEiuhzAIpy3DgcUWR8RXQjgv0KfXQFmPsvM46qsL8c0ALGccWMrdLfewNbX7EH+gwD+hIj2ENG/EtFHc7cnABwzPc5xspWfENFiAGlm3me5S4n1WfgLAD/Ofa3K+lRZhy1E1AmgG8AeAO9n5hOAfiIAcElwK8NG6ImFeSKiKuu7EsBJAP+UKyd9l4imq7I+Zk4D+HsARwGcAPA2Mz8b5PrcWg0rT5nJVtMAtAHoAfBRAJuJ6EpUMdnK5/V9DXpJpOjHbG6r+/qY+Ye5xzwA3VJ6U73XVwZV1lEEEf0RgKcBrGTm3xHZLbX+ENFnAbzFzC8S0ceCXo8N0wB8GMCXmXkPEX0bevlDCXK19luhlynHATxJRCuCXFPDB3kuPdnqiwC2sF4oe4GIpqAbCdVtspXT+ohoHvQ3yr5cALgcwEtEdJ0K6zOt8y4AnwXw8dzriHqurwyqrKMAItKgB/hNzLwld/OviehSZj5BRJcCeMv5GXylF8BiIroZwHsAXEhEjyq0vuMAjjPzntz3T0EP8qqs7xMADjHzSQAgoi3QZ18Htr5mL9ekoE+0AhF9EPomzm+gwGQrZh5j5kuYuZOZO6G/uT/MzL9SYX2ArlwB8FUAi5l5wnSXEusD8AsAVxHRLCJqAXBHbm2BQfoZ+3sAXmXmDaa7tgK4K/f1XQB+WO+1AQAzDzDz5bn33B0AdjLzCoXW9ysAx4hoTu6mj0MfTqTE+qCXaXqIqDX3t/449H2X4NYXxA60Kv+gB/VHAfw7gJcA3GS67wHoyowDAD6jwFoPI6euUWV90DdUjwEYzf37R5XWl1vHzdAVLAehl5iC/jv+F+glo5dNr9vNAN4H4HnoIzSfB9CuwFo/hvPqGmXWB6ALwN7ca5iCXnJVaX1rAPwyF1f+L3SVWWDrE1sDQRCEBqbZyzWCIAgNjQR5QRCEBkaCvCAIQgMjQV4QBKGBkSAvCILQwEiQFwRBaGAkyAuCIDQw/x+lYu+hI0dRbAAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(tsne_emb[:,0], tsne_emb[:, 1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
